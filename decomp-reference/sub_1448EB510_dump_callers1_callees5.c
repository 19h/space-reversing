// Decompiled code dump generated by Code Dumper (Callers/Callees/Refs)
// Start Function: 0x1448EB510 (sub_1448EB510)
// Caller Depth: 1
// Callee/Ref Depth: 5
// Total Functions Found: 20
// ------------------------------------------------------------

// --- Function: sub_1402A24F0 (0x1402A24F0) ---
__int64 __fastcall sub_1402A24F0(__int64 a1)
{
  return a1;
}

// --- End Function: sub_1402A24F0 (0x1402A24F0) ---

// --- Function: ?StopProfileThreadUsage@MemoryMgr@AK@@YA_KXZ (0x1402A3180) ---
__int64 __fastcall AK::MemoryMgr::StopProfileThreadUsage(struct _exception *a1)
{
  return 0;
}

// --- End Function: ?StopProfileThreadUsage@MemoryMgr@AK@@YA_KXZ (0x1402A3180) ---

// --- Function: allocWithProfilerInfo_w (0x1402A3D40) ---
__int64 __fastcall sub_1402A3D40(unsigned __int64 allocSize)
{
  return allocWithProfilerInfo(allocSize, 0);
}

// --- End Function: allocWithProfilerInfo_w (0x1402A3D40) ---

// --- Function: sub_1402B1680 (0x1402B1680) ---
_QWORD *__fastcall sub_1402B1680(_QWORD *a1)
{
  a1[1] = "bad array new length";
  *a1 = off_1481A05A8;
  return a1;
}

// --- End Function: sub_1402B1680 (0x1402B1680) ---

// --- Function: ?_Raise@exception@stdext@@QEBAXXZ (0x1402E0F50) ---
void __fastcall __noreturn stdext::exception::_Raise(stdext::exception *this)
{
  if ( std::_Raise_handler )
    std::_Raise_handler(this);
  (*(void (__fastcall **)(stdext::exception *))(*(_QWORD *)this + 0x10LL))(this);
  invoke_watson(0, 0, 0, 0, 0);
}

// --- End Function: ?_Raise@exception@stdext@@QEBAXXZ (0x1402E0F50) ---

// --- Function: sub_1402E1170 (0x1402E1170) ---
void __noreturn sub_1402E1170()
{
  stdext::exception *v0; // rax
  _QWORD v1[3]; // [rsp+20h] [rbp-18h] BYREF

  v0 = (stdext::exception *)sub_1402B1680(v1);
  stdext::exception::_Raise(v0);
}

// --- End Function: sub_1402E1170 (0x1402E1170) ---

// --- Function: unknown_libname_10 (0x1402E1F90) ---
// Microsoft VisualC v14 64bit runtime
void __noreturn unknown_libname_10()
{
  std::_Xlength_error("vector too long");
}

// --- End Function: unknown_libname_10 (0x1402E1F90) ---

// --- Function: ?allocate@?$allocator@V?$array@H$01@std@@@std@@QEAAPEAV?$array@H$01@2@_K@Z (0x1402E2170) ---
std::array<int,2> *__fastcall std::allocator<std::array<int,2>>::allocate(
        std::allocator<std::array<int,2> > *this,
        unsigned __int64 _Count)
{
  unsigned __int64 allocSize; // rcx
  __int64 v3; // rax
  __int64 v4; // rcx
  std::array<int,2> *result; // rax

  if ( _Count > 0x1FFFFFFFFFFFFFFFLL )
    goto LABEL_10;
  allocSize = 8 * _Count;
  if ( 8 * _Count < 0x1000 )
  {
    if ( allocSize )
      return (std::array<int,2> *)allocWithProfilerInfo_w(allocSize);
    else
      return 0;
  }
  if ( allocSize + 0x27 < allocSize )
LABEL_10:
    sub_1402E1170();
  v3 = allocWithProfilerInfo_w(allocSize + 0x27);
  v4 = v3;
  if ( !v3 )
    invalid_parameter_noinfo_noreturn();
  result = (std::array<int,2> *)((v3 + 0x27) & 0xFFFFFFFFFFFFFFE0uLL);
  *((_QWORD *)result + 0xFFFFFFFF) = v4;
  return result;
}

// --- End Function: ?allocate@?$allocator@V?$array@H$01@std@@@std@@QEAAPEAV?$array@H$01@2@_K@Z (0x1402E2170) ---

// --- Function: sub_140343300 (0x140343300) ---
void __fastcall sub_140343300(__int64 a1, unsigned __int64 _Count, const void ***a3, const void ***a4)
{
  std::array<int,2> *v8; // rax
  void **v9; // rdi
  const void **v10; // rsi
  const void **i; // rbx

  if ( _Count )
  {
    if ( _Count > 0x1FFFFFFFFFFFFFFFLL )
      unknown_libname_10();
    v8 = std::allocator<std::array<int,2>>::allocate((std::allocator<std::array<int,2> > *)a1, _Count);
    *(_QWORD *)a1 = v8;
    v9 = (void **)v8;
    *(_QWORD *)(a1 + 8) = v8;
    *(_QWORD *)(a1 + 0x10) = (char *)v8 + 8 * _Count;
    v10 = *a4;
    for ( i = *a3; i != v10; ++i )
      sub_14035B160(v9++, i);
    *(_QWORD *)(a1 + 8) = v9;
  }
}

// --- End Function: sub_140343300 (0x140343300) ---

// --- Function: sub_14035B160 (0x14035B160) ---
void **__fastcall sub_14035B160(void **a1, const void **a2)
{
  size_t Size; // rsi
  _DWORD *v5; // rax

  *a1 = (char *)&qword_149B3B33C + 4;
  Size = *((int *)*a2 - 2);
  if ( (_DWORD)Size )
  {
    v5 = (_DWORD *)allocWithProfilerInfo(Size + 9, 0);
    *a1 = v5 + 2;
    *v5 = Size;
    v5[1] = Size;
    *((_BYTE *)*a1 + Size) = 0;
    if ( *a1 != *a2 )
      memcpy(*a1, *a2, Size);
  }
  return a1;
}

// --- End Function: sub_14035B160 (0x14035B160) ---

// --- Function: sub_14035D3E0 (0x14035D3E0) ---
_QWORD *__fastcall sub_14035D3E0(_QWORD *a1, const void ***a2)
{
  *a1 = 0;
  a1[1] = 0;
  a1[2] = 0;
  sub_140343300((__int64)a1, a2[1] - *a2, a2, a2 + 1);
  return a1;
}

// --- End Function: sub_14035D3E0 (0x14035D3E0) ---

// --- Function: sub_14056A7D0 (0x14056A7D0) ---
char __fastcall sub_14056A7D0(char a1)
{
  char n2; // al

  switch ( a1 )
  {
    case 1:
    case 2:
    case 3:
    case 4:
    case 5:
    case 6:
    case 7:
    case 8:
    case 84:
    case 85:
    case 86:
    case 87:
      n2 = 1;
      break;
    case 9:
    case 10:
      n2 = 2;
      break;
    case 11:
    case 12:
    case 13:
    case 14:
    case 16:
    case 17:
    case 20:
    case 21:
    case 22:
    case 23:
    case 24:
    case 25:
    case 26:
    case 27:
    case 28:
    case 29:
    case 30:
    case 31:
    case 32:
      n2 = 3;
      break;
    case 15:
    case 18:
    case 19:
    case 65:
      n2 = 11;
      break;
    case 33:
    case 41:
    case 42:
    case 48:
    case 50:
    case 52:
    case 53:
    case 55:
    case 61:
    case 71:
    case 72:
    case 76:
      n2 = 25;
      break;
    case 34:
    case 69:
    case 96:
    case 97:
      n2 = 4;
      break;
    case 35:
    case 36:
    case 37:
    case 68:
      n2 = 5;
      break;
    case 38:
    case 77:
      n2 = 6;
      break;
    case 39:
      n2 = 7;
      break;
    case 40:
      n2 = 9;
      break;
    case 44:
    case 45:
    case 47:
    case 60:
    case 62:
    case 73:
    case 74:
      n2 = 10;
      break;
    case 49:
      n2 = 30;
      break;
    case 54:
      n2 = 21;
      break;
    case 56:
    case 57:
    case 59:
      n2 = 28;
      break;
    case 58:
    case 79:
    case 80:
      n2 = 12;
      break;
    case 63:
    case 75:
      n2 = 27;
      break;
    case 64:
    case 78:
      n2 = 23;
      break;
    case 66:
    case 67:
      n2 = 26;
      break;
    case 70:
      n2 = 29;
      break;
    case 82:
    case 83:
      n2 = 14;
      break;
    case 88:
    case 89:
      n2 = 24;
      break;
    case 90:
    case 91:
      n2 = 15;
      break;
    case 92:
      n2 = 16;
      break;
    case 93:
    case 94:
    case 95:
      n2 = 17;
      break;
    case 98:
    case 99:
      n2 = 18;
      break;
    case 100:
      n2 = 19;
      break;
    case 101:
    case 102:
      n2 = 20;
      break;
    case 103:
      n2 = 22;
      break;
    case 104:
      n2 = 31;
      break;
    case 105:
      n2 = 51;
      break;
    case 106:
      n2 = 52;
      break;
    case 107:
      n2 = 53;
      break;
    default:
      n2 = 0;
      break;
  }
  return n2;
}

// --- End Function: sub_14056A7D0 (0x14056A7D0) ---

// --- Function: sub_1448EB510 (0x1448EB510) ---
__int64 __fastcall sub_1448EB510(
        __int64 a1,
        __int64 a2,
        const void ***a3,
        __int64 p_ItemCount,
        _DWORD *a5,
        const char *p_ItemVolumeMicroSCU,
        _QWORD *a7)
{
  sub_1402A24F0(a1);
  *(_QWORD *)a1 = *a7;
  *(_QWORD *)(a1 + 8) = p_ItemVolumeMicroSCU;
  *(_DWORD *)(a1 + 0x10) = *a5;
  *(_QWORD *)(a1 + 0x18) = p_ItemCount;
  sub_14035D3E0((_QWORD *)(a1 + 0x20), a3);
  return a1;
}

// --- End Function: sub_1448EB510 (0x1448EB510) ---

// --- Function: sub_1448FF5F0 (0x1448FF5F0) ---
__int64 __fastcall sub_1448FF5F0(__int64 *a1, __int64 a2, _DWORD *src)
{
  _BYTE *v3; // rax
  __int64 v4; // rax
  unsigned __int8 v6; // [rsp+40h] [rbp-F8h]
  int v7; // [rsp+44h] [rbp-F4h] BYREF
  __int64 v8; // [rsp+48h] [rbp-F0h]
  __int64 v9; // [rsp+50h] [rbp-E8h] BYREF
  void *v10; // [rsp+58h] [rbp-E0h] BYREF
  int *v11; // [rsp+60h] [rbp-D8h]
  __int64 v12; // [rsp+68h] [rbp-D0h]
  __int64 v13; // [rsp+70h] [rbp-C8h]
  __int64 (__fastcall *v14)(__int64, _BYTE *); // [rsp+78h] [rbp-C0h]
  _BYTE v15[8]; // [rsp+80h] [rbp-B8h] BYREF
  _BYTE *v16; // [rsp+88h] [rbp-B0h]
  __int64 (__fastcall *v17)(__int64, __int64 *, _BYTE *); // [rsp+90h] [rbp-A8h]
  __int64 *v18; // [rsp+98h] [rbp-A0h]
  __int64 v19; // [rsp+A0h] [rbp-98h] BYREF
  __int64 v20[5]; // [rsp+A8h] [rbp-90h] BYREF
  unsigned int v21[4]; // [rsp+D0h] [rbp-68h] BYREF
  unsigned int v22[8]; // [rsp+E0h] [rbp-58h] BYREF
  _BYTE dst_[16]; // [rsp+100h] [rbp-38h] BYREF
  _QWORD v24[5]; // [rsp+110h] [rbp-28h] BYREF

  CreateStringObjectFromString(&v10, "Unknown");
  unknown_libname_472(v22);
  v13 = *a1;
  v14 = *(__int64 (__fastcall **)(__int64, _BYTE *))(*(_QWORD *)*a1 + 0x18LL);
  qmemcpy(dst_, src, sizeof(dst_));
  v8 = v14(v13, dst_);
  if ( v8 )
  {
    v3 = (_BYTE *)(*(__int64 (__fastcall **)(__int64))(*(_QWORD *)v8 + 0x18LL))(v8);
    assignCStringToStringStructure(&v10, v3);
    v4 = (*(__int64 (__fastcall **)(__int64))(*(_QWORD *)v8 + 0x78LL))(v8);
    sub_14035FD10(&v7, v4);
    v11 = &v7;
    sub_1403E2850((__int64)&v7, v21);
    sub_1403E55E0((__int64)v11, v24);
    while ( sub_14037F800(v21, v24) )
    {
      sub_140380320(v21, (__int64)v15);
      v16 = v15;
      v12 = *(_QWORD *)(sub_1402A24F0((__int64)&qword_149B4FBE0) + 0x18);
      v17 = *(__int64 (__fastcall **)(__int64, __int64 *, _BYTE *))(*(_QWORD *)v12 + 0x48LL);
      v18 = (__int64 *)v17(v12, &v19, v16);
      sub_140344750((__int64)v22, v18);
      sub_140370D10(&v19);
      sub_140380370(v21);
    }
    sub_1403729F0(&v7);
  }
  LODWORD(v9) = src[4];
  v20[0] = (__int64)AK::WriteBytesMem::Bytes((AK::WriteBytesMem *)(src + 6));
  sub_1448EB510(a2, v6, (unsigned int)v22, (unsigned int)"ItemCount", (__int64)&v9, "ItemVolumeMicroSCU", (__int64)v20);
  v20[1] = a2 + 0x38;
  *(_QWORD *)(a2 + 0x38) = "Tags";
  v20[2] = a2 + 0x40;
  v20[3] = a2 + 0x40;
  sub_14035B160((void **)(a2 + 0x40), (const void **)&v10);
  v20[4] = a2 + 0x48;
  *(_QWORD *)(a2 + 0x48) = "EntityClassName";
  sub_1402B2610((__int64 *)v22);
  sub_140370D10(&v10);
  return a2;
}

// --- End Function: sub_1448FF5F0 (0x1448FF5F0) ---

// --- Function: sub_1474DA7B0 (0x1474DA7B0) ---
__int64 sub_1474DA7B0()
{
  __int64 result; // rax

  result = *(_QWORD *)(*((_QWORD *)NtCurrentTeb()->ThreadLocalStoragePointer + (unsigned int)TlsIndex) + 3672LL);
  if ( result )
    return *(unsigned __int8 *)(result + 1);
  return result;
}

// --- End Function: sub_1474DA7B0 (0x1474DA7B0) ---

// --- Function: sub_1476030D0 (0x1476030D0) ---
unsigned __int64 __fastcall sub_1476030D0(unsigned __int64 n0xE000_1, unsigned __int64 profilerInfo)
{
  return sub_1476030E0(n0xE000_1, profilerInfo);
}

// --- End Function: sub_1476030D0 (0x1476030D0) ---

// --- Function: sub_1476052F0 (0x1476052F0) ---
double __fastcall sub_1476052F0(unsigned __int64 n0x6400000)
{
  _QWORD pExceptionObject[2]; // [rsp+30h] [rbp-68h] BYREF
  int n26880; // [rsp+40h] [rbp-58h] BYREF
  __int64 v5; // [rsp+44h] [rbp-54h]
  int v6; // [rsp+4Ch] [rbp-4Ch]
  unsigned __int64 v7; // [rsp+50h] [rbp-48h]
  unsigned __int64 v8; // [rsp+58h] [rbp-40h]
  __int64 v9; // [rsp+60h] [rbp-38h]
  __int64 v10; // [rsp+68h] [rbp-30h]

  if ( byte_1517022EC == 1 )
  {
    sub_141848E00(pExceptionObject);
    throw (stdext::bad_alloc *)pExceptionObject;
  }
  byte_149B4FEA4 = 1;
  qword_149B4FEA8 = n0x6400000;
  if ( n0x6400000 > 0x6400000 )
    sub_1475DF210(n0x6400000);
  n26880 = 26880;
  v6 = 0;
  v8 = 0;
  v9 = 0;
  v10 = 0;
  v5 = 1;
  v7 = __rdtsc();
  qword_149B4B870(
    &n26880,
    &word_1517023A0,
    "OnMemoryAllocationFailure",
    "W:/p4-src/CryEngine/Code/CryEngine/CrySystem/CryMemoryManager.cpp",
    167);
  HIWORD(n26880) = word_1517023A0;
  sub_1475DF210(n0x6400000);
  v8 = __rdtsc();
  return qword_149B4B878(&n26880);
}

// --- End Function: sub_1476052F0 (0x1476052F0) ---

// --- Function: allocWithProfilerInfo (0x147605A30) ---
__int64 __fastcall allocWithProfilerInfo(unsigned __int64 allocSize, struct _exception *profilerInfo)
{
  char v4; // al
  __int64 v5; // rax
  __int64 result; // rax

  if ( allocSize )
  {
    v4 = sub_1474DA7B0();
    sub_14056A7D0(v4);
    v5 = AK::MemoryMgr::StopProfileThreadUsage(profilerInfo);
    result = sub_1476030D0(v5 + allocSize, (unsigned __int64)profilerInfo);
    if ( result )
      return result;
    sub_1476052F0(allocSize);
  }
  return 0;
}

// --- End Function: allocWithProfilerInfo (0x147605A30) ---

// --- Function: ?_Xlength_error@std@@YAXPEBD@Z (0x14803278E) ---
// attributes: thunk
void __fastcall __noreturn std::_Xlength_error(const char *a1)
{
  __imp_?_Xlength_error@std@@YAXPEBD@Z(a1);
}

// --- End Function: ?_Xlength_error@std@@YAXPEBD@Z (0x14803278E) ---

// --- Function: memcpy (0x14808212B) ---
// attributes: thunk
void *__cdecl memcpy(void *a1, const void *Src, size_t Size)
{
  return __imp_memcpy(a1, Src, Size);
}

// --- End Function: memcpy (0x14808212B) ---

